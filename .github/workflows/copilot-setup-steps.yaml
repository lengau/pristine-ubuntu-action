name: Copilot Setup Steps

on:
  workflow_dispatch:

jobs:
  setup:
    runs-on: ubuntu-latest
    
    steps:
      # First step: Use pristine-ubuntu-action as required
      - name: Pristine Ubuntu
        if: ${{ runner.os == 'Linux' && runner.environment == 'github-hosted' }}
        uses: lengau/pristine-ubuntu-action@v0
      
      - name: Checkout repository
        uses: actions/checkout@v4
      
      - name: Install YAML linting tools
        run: |
          sudo apt-get update
          sudo apt-get install -y yamllint
      
      - name: Install actionlint for GitHub Actions validation
        run: |
          bash <(curl https://raw.githubusercontent.com/rhysd/actionlint/main/scripts/download-actionlint.bash)
          sudo mv ./actionlint /usr/local/bin/
      
      - name: Install shellcheck for shell script validation
        run: |
          sudo apt-get install -y shellcheck
      
      - name: Validate action.yaml syntax
        run: |
          yamllint action.yaml || true
          actionlint action.yaml || true
      
      - name: Validate workflow files
        run: |
          yamllint .github/workflows/*.yaml || true
          actionlint .github/workflows/*.yaml || true
      
      - name: Check shell scripts in action.yaml
        run: |
          echo "Extracting and validating shell scripts from action.yaml"
          # Note: In a real setup, you might extract shell scripts and run shellcheck
          echo "Shell validation would run here"
      
      - name: Setup development environment complete
        run: |
          echo "Development environment is ready for GitHub Copilot coding agent"
          echo "Tools available:"
          echo "  - yamllint: $(yamllint --version)"
          echo "  - actionlint: $(actionlint --version)"
          echo "  - shellcheck: $(shellcheck --version)"
          echo ""
          echo "Key files:"
          echo "  - action.yaml (main action definition)"
          echo "  - README.md (documentation)"
          echo "  - .github/AGENTS.md (agent instructions)"
          echo ""
          echo "Repository structure validated and ready for agentic coding"
