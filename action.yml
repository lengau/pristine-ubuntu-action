# action.yaml
name: Pristine Ubuntu
description: Remove the clutter from GitHub's hosted Ubuntu runners

inputs:
  keep-android:
    description: Opt into keeping the Android SDK
    default: ''

runs:
  using: 'composite'
  steps:
    - name: Delete the Android SDK
      # https://github.com/actions/runner-images/blob/main/images/ubuntu/scripts/build/install-android-sdk.sh
      shell: bash
      id: android-sdk
      if: ${{ inputs.keep-android != '' }}
      run: |
        nohup sudo rm -rf /usr/local/lib/android/ >& /dev/null &
    - name: Delete local binaries
      shell: bash
      id: local-bins
      run: |
        nohup sudo rm -f /usr/local/bin/* >& /dev/null &
    - name: Remove Chromedriver
      # https://github.com/actions/runner-images/blob/main/images/ubuntu/scripts/build/install-google-chrome.sh
      shell: bash
      id: chromedriver
      run: |
        nohup sudo rm -rf /usr/local/share/chromedriver-linux64 >& /dev/null &
        nohup sudo rm -rf /usr/local/share/chromium >& /dev/null &
    - name: Remove Julia
      # https://github.com/actions/runner-images/blob/main/images/ubuntu/scripts/build/install-julia.sh
      shell: bash
      run: |
        nohup sudo rm -rf /usr/local/julia* >& /dev/null &
        if [[ -L /usr/bin/julia ]]; then
          sudo rm /usr/bin/julia
        fi
    - name: Uninstall Temurin Java (including ant)
      shell: bash
      id: temurin
      run: |
        echo "JAVA_HOME=" >> "${GITHUB_ENV}"
        sudo apt-get --yes purge temurin-* ant default-jre-headless


